# -*- coding: utf-8 -*-
# Author : jeonghoonkang , https://github.com/jeonghoonkang

# 참고 url
# https://code.tutsplus.com/ko/tutorials/how-to-work-with-excel-documents-using-python--cms-25698
# http://egloos.zum.com/mcchae/v/11120944
# https://xlsxwriter.readthedocs.io/


import kw
import sitenum

import datetime
from openpyxl import Workbook
import openpyxl
import time
# import XlsxWriter
import sys
# sys.path.insert(0, '../doc_design')
# (to do) have to find how to add different location directory path and file
# now just using same dir location file

# from openpyxl.workbook import Workbook
# from openpyxl.writer.excel import ExcelWriter
# (error) from openpyxl.cell import get_column_letter
# from openpyxl import load_workbook

global EE_file
global EA_file

class excell_class :
    __ofile = None

    def __init__(self):
        pass

    #@staticmethod
    def open_exc_doc(self,__file):
        # using unicode file name with u syntax
        __ofile = openpyxl.load_workbook(__file)

        #pout = "ix: %s, mdsid: %s, donecheck: %d \r" %(ix, mds_id, donecheck)
        pout = "   ... file opened \n"
        sys.stdout.write(pout)
        sys.stdout.flush()
        return __ofile

    def read_vertical(self, sheet, __start, __end):
        __vertical = []
        #print " ... Please use column[n]:column[m], vertical read "
        cell_of_col = sheet[__start:__end]
        for row in cell_of_col:
            for cell in row:
                v = cell.value
                if v == None:
                    continue # do nothing below code, back to next for loop step
                __vertical.append(v) # 리스트 __vertical에 아이디 추가
        return __vertical #__cnt, __cnt_n # 세로 셀 데이터, 데이터 갯수, None 갯수

    def save_vdata(self,  __list, __lname = None):
        #리스트 내부, 숫자를 모두 유니코드로 변환
        __list = [unicode(i) for i in __list]
        __t = str(datetime.datetime.now())
        __odata = 'save_list='
        if __lname != None : __odata = __lname +'_list='
        __odata = __odata + str(__list)
        filename = '__output_list_'+__t+'.py'
        if __lname != None : filename = __lname + filename

        __ofile = open(filename,"w")
        __ofile.write(__odata)
        __ofile.close()


def merge_list(__tl, __list1, __list2):
    __tl = [ [__list1[k], __list2[k]] for k in range(len(__list1)) ]
    return __tl

if __name__ == "__main__":
    _kw__list=[u'3.9', u'1.116', u'1.375', u'5.18', u'4.096', u'0.786', u'1.44', u'1.44', u'2.415', u'0.496', u'0.882', u'0.774', u'1.116', u'1.044', u'0.324', u'0.18', u'0.9', u'0.46', u'1.44', u'1.92', u'1.532', u'7.854', u'1.491', u'1.28', u'0.72', u'0.72', u'0.48', u'0.464', u'2.591', u'2.843', u'3.004', u'2.767', u'2.617', u'2.813', u'0.72', u'0.72', u'0.42', u'0.3', u'0.3', u'0.48', u'5.32', u'1.8', u'1.86', u'0.3', u'2.52', u'0.195', u'0.96', u'3.6', u'1.533', u'2.97', u'0.846', u'0.288', u'2.48', u'1.62', u'1.87', u'0.96', u'3.08', u'44.4', u'1.62', u'2.4', u'3.953', u'0.684', u'1.681', u'0.42', u'20.574', u'2.96', u'2.08', u'0.48', u'0.54', u'0.54', u'0.48', u'0.36', u'4.356', u'7.68', u'3.264', u'1.829', u'2.4', u'3', u'1.2', u'1.705', u'5.64', u'1.373', u'1.2648', u'0.868', u'1.35', u'0.9', u'0.99', u'1.04', u'0.9', u'3.72', u'5.61', u'1', u'1.4', u'0.764', u'2.448', u'1.768', u'0.72', u'2.46', u'2.025', u'1.4', u'1.95', u'25.9904', u'1.4', u'1.23', u'1.14', u'4', u'4', u'4.7', u'5.4', u'1.152', u'0.75', u'2.009', u'0.96', u'1.33', u'2.31', u'1.89', u'1.75', u'6.246', u'1.74', u'0.8', u'0.8', u'4.59', u'4.59', u'4.59', u'4.59', u'1.6', u'1.6', u'0.48', u'0.8', u'0.96', u'1.6', u'0.63', u'0.8', u'0.9', u'1', u'0.27', u'0.72', u'0.54', u'1.65', u'0.9', u'0.3', u'0.4', u'1200', u'1.04', u'1.83', u'0.88', u'0.4', u'0.56', u'0.64', u'1.4', u'1.1', u'1', u'0.56', u'1.92', u'1.28', u'1.2', u'1.32', u'2', u'2', u'0.648', u'0.612', u'0.6', u'1.29', u'0.96', u'0.945', u'0.72', u'0.855', u'4.2', u'1.02', u'1.74', u'0.84', u'1.1', u'0.54', u'0.54', u'0.6', u'6.048', u'0.768', u'0.768', u'0.992', u'0.978', u'1.27', u'1.284', u'1.197', u'1.46', u'0.963', u'0.438', u'1.226', u'2.24', u'1.26', u'1.12', u'0.4', u'0.464', u'0.24', u'0.8595', u'1', u'0.3', u'1.2', u'1.71', u'0.9', u'1.12', u'2', u'0.77', u'0.28', u'1.428', u'0.917', u'0.707', u'0.959', u'1.414', u'1.54', u'0.651', u'1.204', u'0.28', u'0.315', u'0.546', u'0.322', u'0.903', u'3.84', u'0.676', u'0.676', u'1.05', u'0.57', u'5.461', u'1.414', u'2.1', u'0.48', u'0.68', u'0.684', u'0.936', u'0.78', u'0.78', u'1.04', u'1.04', u'1.04', u'1.75', u'1.75', u'1.6', u'1.12', u'1.12', u'3.3', u'2.4', u'2.72', u'0.504', u'2.56', u'2.16', u'2.664', u'0.8232', u'0.8', u'1.764', u'2.1462', u'1.2936', u'1.2', u'1.0878', u'1.5582', u'4.68', u'0.441', u'1.05', u'0.764', u'3.04', u'3', u'1.5876', u'0.617', u'0.617', u'0.617', u'8.352', u'1.117', u'1.176', u'1.029', u'0.84', u'1.26', u'1.0878', u'1.026', u'0.54', u'1.5288', u'1.0584', u'0.8949', u'1.296', u'0.72', u'4.5', u'1.32', u'1.32', u'1.08', u'1.08', u'0.392', u'1.235', u'1.205', u'1.638', u'0.828', u'0.94', u'0.94', u'1.088', u'0.94', u'1.3524', u'1.411', u'0.676', u'0.676', u'0.706', u'1.8', u'1.911', u'3.584', u'0.738', u'0.702', u'2.112', u'3.52', u'1.92', u'2.24', u'0.9996', u'1.92', u'1.566', u'2.688', u'0.7938', u'1.08', u'1.5096', u'1.058', u'1.98', u'1.05', u'0.72', u'0.36', u'0.27', u'0.832', u'1.92', u'0.882', u'0.9114', u'0.8967', u'1.856', u'1.15', u'2.816', u'3.072', u'2.688', u'1.52', u'1.152', u'3.13', u'2.496', u'1.2348', u'0.814', u'0.532', u'0.456', u'0.36', u'0.36', u'0.954', u'0.216', u'4.55', u'2.6', u'0.952', u'0.884', u'0.384', u'0.648', u'2.752', u'1.006', u'0.676', u'0.936', u'1.206', u'1.254', u'1.254', u'0.55883', u'2.142', u'2.61', u'0.476', u'0.476', u'0.6', u'0.7', u'0.6', u'0.6', u'1.17', u'0.832', u'0.832', u'0.832', u'0.702', u'0.598', u'2.79', u'1.3', u'1', u'0.9', u'2.2', u'1', u'1.2', u'0.6', u'0.6', u'0.48', u'0.64', u'1.17', u'0.9', u'0.48', u'0.48', u'0.86', u'1.5', u'1.5', u'0.72', u'1.0437', u'0.6512', u'1.026', u'0.558', u'0.79', u'0.496', u'0.4424', u'0.864', u'0.4', u'0.4', u'0.75', u'1.2', u'0.8', u'0.64', u'0.427', u'0.3355', u'2.8', u'25.245', u'19.635', u'17.325', u'21.945', u'23.76', u'18.32', u'24.09', u'20.95', u'22.935', u'10.861', u'7.26', u'10.725', u'10.23', u'1.92', u'2.4', u'2.88', u'10.36', u'9.6', u'2.8', u'8', u'13.7', u'4.5', u'1.656', u'1.68', u'4.6', u'7.68', u'2.16', u'0.36', u'0.45', u'25.26', u'8.96', u'21.9', u'23.76', u'15.68', u'20.02', u'26.07', u'6.66', u'3.56', u'1.4', u'832', u'1408', u'27.225', u'17.325', u'21.945', u'27.06', u'25.885', u'27.555', u'20.13', u'19.305', u'13.057', u'7.2', u'23.1', u'21.945', u'6.15', u'21.5', u'2.25', u'9.4', u'13.27', u'6.33', u'7.112', u'5.376', u'5,76', u'2.08', u'0.96', u'1.89', u'7.008', u'8.19', u'23.808', u'20.15', u'1.566', u'52.92', u'69.3', u'32.34', u'69.3', u'44.1', u'12.936', u'12.936', u'47.25', u'47.25', u'8.82', u'10.878', u'21.756', u'21.756', u'47.25', u'55.86', u'52.92', u'64.68', u'64.68', u'54.2625', u'28.35', u'47.25', u'23.31', u'12.936', u'23.31', u'26.46', u'32.34', u'6.468', u'108.78', u'108.78', u'21.756', u'21.756', u'21.756', u'8.82', u'23.31', u'17.64', u'23.31', u'50.58', u'26.46', u'21.756', u'100.8', u'17.64', u'17.64', u'32.34', u'10.878', u'12.936', u'10.878', u'10.878', u'32.34', u'12.936', u'12.936', u'12.936', u'12.936', u'21.756', u'17.64', u'17.64', u'17.64', u'17.64', u'12.936', u'64.68', u'17.64', u'17.64', u'12.936', u'17.64', u'17.64', u'64.68', u'17.64', u'32.34', u'44.1', u'129.36', u'116.55', u'70.56', u'56.7', u'17.64', u'17.64', u'52.92', u'3.234', u'4.41', u'4.41', u'3.234', u'12.936', u'77.616', u'77.616', u'47.25', u'47.25', u'32.34', u'17.64', u'55.86', u'12.936', u'12.936', u'12.936', u'10.878', u'10.878', u'17.64', u'44.1', u'94.08', u'32.34']

    _sitenum__list=[u'201602220001', u'201602220002', u'201602220005', u'201602220007', u'201602220008', u'201602220009', u'201602220010', u'201602220015', u'201602220016', u'201602220018', u'201602220019-1', u'201602220019-2', u'201602220019-3', u'201602220019-4', u'201602220021-1', u'201602220021-2', u'201602220022', u'201602220023', u'201602220024', u'201602220025', u'201602230003', u'201602230006', u'201602230018', u'201602230020', u'201602230024-1', u'201602230024-2', u'201602230026-1', u'201602230026-2', u'201602230028-1', u'201602230028-2', u'201602230028-3', u'201602230028-4', u'201602230028-5', u'201602230028-6', u'201602230029-1', u'201602230029-2', u'201602230049-1', u'201602230049-2', u'201602230049-3', u'201602230049-4', u'201602230054', u'201602230056', u'201602240006', u'201602240009', u'201602240012', u'201602240014-1', u'201602240014-2', u'201602240017', u'201602240021', u'201602240028', u'201602240029-1', u'201602240029-2', u'201602240030', u'201602240032', u'201602240033', u'201602240037', u'201602240038', u'201602240056', u'201602240058', u'201602240069', u'201602240084-1', u'201602240084-2', u'201602240084-3', u'201602240084-4', u'201602240085', u'201602240086', u'201602240087-1', u'201602240087-2', u'201602240088', u'201602240089-1', u'201602240089-2', u'201602240091', u'201602240094', u'201602240095', u'201602240098', u'201602240100', u'201602240101', u'201602250004-1', u'201602250004-2', u'201602250004-3', u'201602250006', u'201602250007', u'201602250008', u'201602250009-1', u'201602250009-2', u'201602250013', u'201602250017-1', u'201602250017-2', u'201602250024', u'201602250026', u'201602250028', u'201602250029', u'201602250030-1', u'201602250030-2', u'201602250032', u'201602250033-1', u'201602250033-2', u'201602250035-1', u'201602250035-2', u'201602250036', u'201602250039', u'201602250040', u'201602250042', u'201602250047', u'201602250050', u'201602250052', u'201602250056-1', u'201602250056-2', u'201602250056-3', u'201602250056-4', u'201602250058', u'201602250060', u'201602250062', u'201602250063', u'201602250071-1', u'201602250071-2', u'201602250071-3', u'201602250071-4', u'201602250073', u'201602260001', u'201602260002', u'201602260003', u'201602260005-1', u'201602260005-2', u'201602260005-3', u'201602260005-4', u'201602260012-1', u'201602260012-2', u'201602260013', u'201602260015', u'201602260016', u'201602260017', u'201602260018', u'201602260019', u'201602260020', u'201602260022', u'201602260023', u'201602260024-1', u'201602260024-2', u'201602260026', u'201602260027', u'201602260028', u'201602260030', u'201602260031', u'201602260032', u'201602260033', u'201602260034', u'201602260036-1', u'201602260036-2', u'201602260039', u'201602260040', u'201602260041', u'201602260042', u'201602260043', u'201602260044-1', u'201602260044-2', u'201602260045-1', u'201602260045-2', u'201602260046-1', u'201602260046-2', u'201602260047-1', u'201602260047-2', u'201602260048', u'201602260050', u'201602260051', u'201602260052', u'201602260053-1', u'201602260053-2', u'201602260054-1', u'201602260054-2', u'201602260057', u'201602260058', u'201602260059', u'201602260060-1', u'201602260060-2', u'201602260061', u'201602260062', u'201602260063-1', u'201602260063-2', u'201602260064-1', u'201602260064-2', u'201602260064-3', u'201602260064-4', u'201602260064-5', u'201602260064-6', u'201602260064-7', u'201602260064-8', u'201602260064-9', u'201602260065', u'201602260070', u'201602260075', u'201602260078-1', u'201602260078-2', u'201602260079', u'201602260085-1', u'201602260085-2', u'201602260085-3', u'201602260086', u'201602260089-1', u'201602260089-2', u'201602260090', u'201602260096', u'201602260099', u'201602260100-1', u'201602260100-2', u'201602260102-1', u'201602260102-2', u'201602260102-3', u'201602260105', u'201602260108', u'201602260109', u'201602260110', u'201602260111-1', u'201602260111-2', u'201602260111-3', u'201602260111-4', u'201602260112', u'201602260114', u'201602260115-1', u'201602260115-2', u'201602260118', u'201602260120-1', u'201602260120-2', u'201602260120-3', u'201602260121', u'201602260122', u'201602260123', u'201602260129', u'201602260130', u'201602260137', u'201602260139-1', u'201602260139-2', u'201602260142-1', u'201602260142-2', u'201602260142-3', u'201602260142-4', u'201602260142-5', u'201602260143-1', u'201602260143-2', u'201602260144', u'201602260146-01', u'201602260146-02', u'201602260149', u'201602260151', u'201602260152', u'201602260153', u'201602260156', u'201602260158', u'201602260161', u'201602260162', u'201602260164', u'201602260166', u'201602260168', u'201602260169', u'201602260170', u'201602260171', u'201602260172', u'201602260173', u'201602260174', u'201602260175', u'201602260176', u'201602260177-1', u'201602260177-2', u'201602260178', u'201602260179', u'201602260180-1', u'201602260180-2', u'201602260181', u'201602260182', u'201602260183', u'201602260185', u'201602260186', u'201602260188', u'201602260189', u'201602260190', u'201602260191', u'201602260192', u'201602260193', u'201602260196', u'201602260197', u'201602260198', u'201602260199-1', u'201602260199-2', u'201602260199-3', u'201602260199-4', u'201602260199-5', u'201602260200', u'201602260201', u'201602260202', u'201602260204', u'201602260204', u'201602260205-1', u'201602260205-2', u'201602260206', u'201602260208', u'201602260209', u'201602260210', u'201602260211-1', u'201602260211-2', u'201602260212', u'201602260213', u'201602260214', u'201602260216', u'201602260217-1', u'201602260217-2', u'201602260218', u'201602260219', u'201602260221', u'201602260222', u'201602260223', u'201602260225', u'201602260226', u'201602260227', u'201602260228', u'201602260230', u'201602260231', u'201602260232', u'201602260233', u'201602260234', u'201602260235', u'201602260237-1', u'201602260237-2', u'201602260238', u'201602260239', u'201602260240', u'201602260241', u'201602260243', u'201602260244', u'201602260245', u'201602260246', u'201602260247', u'201602260249', u'201602260250', u'201602260251', u'201602260252', u'201602260253', u'201602260255', u'201602260257', u'201602260261-1', u'201602260261-2', u'201602260263-1', u'201602260263-2', u'201602260263-3', u'201602260263-4', u'201602260264-1', u'201602260264-2', u'201602260265-1', u'201602260265-2', u'201602260265-3', u'201602260265-4', u'201602260267', u'201602260269', u'201602260271', u'201602260272', u'201602260274-1', u'201602260274-2', u'201602260276-1', u'201602260276-2', u'201602260288', u'201602260290-1', u'201602260290-2', u'201602260292-1', u'201602260292-2', u'201602260296-1', u'201602260296-2', u'201602260296-3', u'201602260296-4', u'201602260297-1', u'201602260297-2', u'201602260298-1', u'201602260298-2', u'201602260302', u'201602260303-1', u'201602260303-2', u'201602260303-3', u'201602260304-1', u'201602260304-2', u'201602260305', u'201602260306-1', u'201602260306-2', u'201602260306-3', u'201602260307', u'201602260308-1', u'201602260308-2', u'201602260309-1', u'201602260309-2', u'201602260311-1', u'201602260311-2', u'201602260312-1', u'201602260312-2', u'201602260313', u'201602260314', u'201602260315', u'201602260316-1', u'201602260316-2', u'201602260317', u'201602260320', u'201602260321', u'201602260322', u'201602260323', u'201602260324', u'201602260325', u'201602260329', u'201602260330', u'201602260331-1', u'201602260331-2', u'201602260332', u'201602260333', u'201602260334-1', u'201602260334-2', u'201602260335-1', u'201602260335-2', u'201602260336', u'201602240074', u'201602240076', u'201602240073', u'201602240068', u'201602240080', u'201602240077', u'201602240079', u'201602240067', u'201602240043', u'201602240071', u'201602240045-1', u'201602240045-2', u'201602240045-3', u'201602260155', u'201602260150-1', u'201602260150-2', u'201602260104', u'201602240020', u'201602250016', u'201602260159', u'201602260113-1', u'201602260113-2', u'201602260131', u'201602260148-1', u'201602260148-2', u'201602260148-3', u'201602260147', u'201602260025-1', u'201602260025-2', u'201602240066', u'201602240053', u'201602240054', u'201602240052', u'201602240048', u'201602240047', u'201602240044', u'201602240041', u'201602230021', u'201602260021', u'201602250012-1', u'201602250012-2', u'201602220012', u'201602240051', u'201602240042', u'201602240063', u'201602240055', u'201602240072', u'201602240075', u'201602240049', u'201602240050', u'201602240039', u'201602240046', u'201602240040', u'201602230017', u'201602230034', u'201602230035', u'201602260084-1', u'201602260084-2', u'201602260084-3', u'201602260084-4', u'201602240027-1', u'201602240027-2', u'201602260132', u'201602260133', u'201602260135', u'201602220003-1', u'201602220003-2', u'201602250049', u'201602230037', u'201602260004', u'201602220011', u'201602220013', u'201602220020', u'201602230009', u'201602230010-1', u'201602230010-2', u'201602230010-3', u'201602230012-1', u'201602230012-2', u'201602230013-1', u'201602230013-2', u'201602230014-1', u'201602230014-2', u'201602230015', u'201602230016', u'201602230023', u'201602230027-1', u'201602230027-2', u'201602230032', u'201602230038', u'201602230039', u'201602230040-1', u'201602230040-2', u'201602230041', u'201602230042', u'201602230043', u'201602230051', u'201602230055-1', u'201602230055-2', u'201602240002-1', u'201602240002-2', u'201602240002-3', u'201602240004', u'201602240008-1', u'201602240008-2', u'201602240011', u'201602240015', u'201602240016', u'201602240019', u'201602240022', u'201602240025-1', u'201602240025-2', u'201602240031', u'201602240057-1', u'201602240057-2', u'201602240057-3', u'201602240059-1', u'201602240059-2', u'201602240060-1', u'201602240060-2', u'201602240061-1', u'201602240061-2', u'201602240062-1', u'201602240062-2', u'201602240064-1', u'201602240064-2', u'201602240070-1', u'201602240070-2', u'201602240078-1', u'201602240078-2', u'201602240078-3', u'201602240082', u'201602240083-1', u'201602240083-2', u'201602240093', u'201602240097', u'201602250005-1', u'201602250005-2', u'201602250010', u'201602250020', u'201602250021', u'201602250027', u'201602250031-1', u'201602250031-2', u'201602250037', u'201602250045-1', u'201602250045-2', u'201602250045-3', u'201602250045-4', u'201602250059', u'201602250064-1', u'201602250064-2', u'201602260077', u'201602260101', u'201602260106', u'201602260125', u'201602260126', u'201602260128-1', u'201602260128-2', u'201602260128-3', u'201602260145-1', u'201602260145-2', u'201602260145-3', u'201602260187', u'201602260248', u'201602260260']


    # 입력파일
    E1_file = u"_2016년 사업장 별 사전계측용량(kW) 리스트.xlsx"
    E2_file = u"__161129_16년 EE시장 계량전송장치 입력현황(본사업)_종합본(최종).xlsx"

    exl_class = excell_class()
    e1 = exl_class.open_exc_doc(E1_file)
    #e2 = cfile.open_exc_doc(E2_file)
    # read_vertical(sh1,'b1','b541')
    sheets = e1.get_sheet_names()
    sh1 = e1.get_sheet_by_name(sheets[0])
    lst = exl_class.read_vertical(sh1,'a2','a580')
    exl_class.save_vdata(lst,'_sitenum_')
    lst = exl_class.read_vertical(sh1,'b2','b580')
    exl_class.save_vdata(lst,'_kw_')
    _m_list = []

    _m_list = merge_list( _m_list, _kw__list, _sitenum__list)
    exl_class.save_vdata(_m_list,'_sanum_kw')
    

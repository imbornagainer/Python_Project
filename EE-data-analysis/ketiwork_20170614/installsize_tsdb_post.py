# -*- coding: utf-8 -*-

import time as newtime
import datetime
import requests
import json
import saupjang_info_list


def timeTOunixtime (rlt):
        #YYYY [0:4], MM [4:6], DD [6:8], HH [8:10], m[10:12]
        stime = "%s/%s/%s" %(rlt[6:8], rlt[4:6], rlt[0:4])
        h = rlt[8:10]

	if len(rlt) == 10: # without minutes
		m = '00'
	else:
        	m = rlt[10:12]

        #unixtime need to have 1 sec unit scale
        dechour = int(h)*60*60
        dechour += int(m)*60
        unixday = newtime.mktime(datetime.datetime.strptime(stime, "%d/%m/%Y").timetuple())
        unixtime = unixday + dechour

        return int(unixtime)

url = "http://125.140.110.217:4242/api/put"
timelist=['2017060100','2016090100','2017022800','2016010100']

installsize_list=saupjang_info_list.installsize
for installdata in installsize_list:
    for time in timelist:
        uxtime = timeTOunixtime(time)
        data = {
            "metric": "rc_001_energy_target",
            "timestamp": uxtime,
            "value": installdata[1], #설비용량(일정 비율을 곱한..값..)
            "tags": {
                "Saupjang": installdata[0] #사업장 번호->사업자 번호가 아니고 사업장 번호여야 함!!!!!

            }
        }
        #print data
        ret = requests.post(url, data=json.dumps(data))


##############################################################################################################
#사업장 리스트
#saupjang_list=[1602220001, 1602160001, 1602200001, 1602220005, 1602220006, 1602220011, 1602220007, 1602170011, 1602230047, 1602220014, 1602220013, 1602220022, 1602220019, 1602220025, 1602220012, 1602220017, 1602220035, 1602220026, 1602160002, 1602220032, 1602220042, 1602220048, 1602220036, 1602220051, 1602230001, 1602230001, 1602230005, 1602230014, 1602180003, 1602230019, 1602190001, 1602220041, 1602220027, 1602220037, 1602220034, 1602220043, 1602230033, 1602230038, 1602230040, 1602220029, 1602230043, 1602230032, 1602230045, 1602230048, 1602230027, 1602230046, 1602230051, 1602230052, 1602220039, 1602230054, 1602230013, 1602220031, 1602220033, 1602220010, 1602230026, 1602220016, 1602220023, 1602220045, 1602220049, 1602230023, 1602230069, 1602220040, 1602230055, 1602230096, 1602230095, 1602220050, 1602240046, 1602250068, 1602230049, 1602230035, 1602230114, 1602240002, 1602240009, 1602240008, 1602240016, 1602240019, 1602240011, 1602240020, 1602240025, 1602240026, 1602240018, 1602240030, 1602240014, 1602240037, 1602240031, 1602240035, 1602240038, 1602240022, 1602240033, 1602240036, 1602220044, 1602240041, 1602230058, 1602240001, 1602240039, 1602240044, 1602240042, 1602240045, 1602240034, 1602230099, 1602240048, 1602240055, 1602240059, 1602230059, 1602230060, 1602230061, 1602230062, 1602230063, 1602230064, 1602230065, 1602230066, 1602230067, 1602230068, 1602230070, 1602230073, 1602230074, 1602230075, 1602230076, 1602230077, 1602230078, 1602230034, 1602230004, 1602170010, 1602230007, 1602230008, 1602230012, 1602230016, 1602230079, 1602230018, 1602230020, 1602230080, 1602230081, 1602230083, 1602240067, 1602230024, 1602230084, 1602230085, 1602230086, 1602230087, 1602230089, 1602230090, 1602230091, 1602230025, 1602230092, 1602230093, 1602230031, 1602230100, 1602230101, 1602240063, 1602240072, 1602180002, 1602230021, 1602240075, 1602240076, 1602240071, 1602240078, 1602240077, 1602240081, 1602240083, 1602240079, 1602250005, 1602240085, 1602240024, 1602240087, 1602240084, 1602240089, 1602250001, 1602240054, 1602250003, 1602240086, 1602250004, 1602250050, 1602250014, 1602250020, 1602250021, 1601040001, 1602250026, 1602250044, 1602250019, 1602250038, 1602250008, 1602250048, 1602240070, 1602240053, 1602250056, 1602240040, 1602250054, 1602240074, 1602250009, 1602240003, 1602240004, 1602250057, 1602220018, 1602230010, 1602250046, 1602240088, 1602240061, 1602250055, 1602240082, 1602240047, 1602250022, 1602250069, 1602250060, 1602240015, 1602250067, 1602250071, 1602250104, 1602250043, 1602250062, 1602250077, 1602250072, 1602250031, 1602250082, 1602250007, 1602250018, 1602250042, 1602250052, 1602250088, 1602240012, 1602240013, 1602250085, 1602250122, 1602250138, 1602250136, 1602250150, 1602250162, 1602250173, 1602250078, 1602250017, 1602250180, 1602250091, 1602230113, 1602250094, 1602250097, 1602250098, 1602250099, 1602250101, 1602250102, 1602250103, 1602250185, 1602250106, 1602250108, 1602250112, 1602250115, 1602250118, 1602250123, 1602250125, 1602260003, 1602260008, 1602260011, 1601040002, 1601140001, 1601140002, 1601140003, 1601140004, 1601140005, 1601140006, 1602010002, 1602010003, 1602040001, 1602040002, 1602040003, 1602040004, 1602040005, 1602040006, 1602040007, 1602040008, 1602040009, 1602040010, 1602150001, 1602150003, 1602150004, 1602170002, 1602170004, 1602170005, 1602170006, 1602170007, 1602170008, 1602170009, 1602180005, 1602180008, 1602190006, 1602190007, 1602190008, 1602190009, 1602190010, 1602220052, 1602230106, 1602230110, 1602230111, 1602250063, 1602250066, 1602250081, 1602250083, 1602250090, 1602260026, 1602260027, 1602260028, 1602260029, 1602250070, 1602250065, 1602250002, 1602250156, 1602260019, 1602250036, 1602260031, 1602260033, 1602250010, 1602250039, 1602250028, 1602260034, 1602260092, 1602220015, 1602260041, 1602260009, 1602260013, 1602240023, 1602260059, 1602260015, 1602260016, 1602260017, 1602260018, 1602260021, 1602260022, 1602260023, 1602260042, 1602260024, 1602260025, 1602250047, 1602250032, 1602220020, 1602260048, 1602220038, 1602250073, 1602230097, 1602250058, 1602260050, 1602230103, 1602250045, 1602240069, 1602230105, 1602250040, 1602250064, 1602260051, 1602260039, 1602260063, 1602260032, 1602230107, 1602260071, 1602240005, 1602240064, 1602250049, 1602250024, 1602230006, 1602260070, 1602260074, 1602230042, 1602260072, 1602260073, 1602250120, 1602250006, 1602250015, 1602230088, 1602250016, 1602260076, 1602260068, 1602260075, 1602260080, 1602260093, 1602250051, 1602260064, 1602260043, 1602240006, 1602260082, 1602260112, 1602260005, 1602250186, 1602260095, 1602260085, 1602260096, 1602240028, 1602260094, 1602260105, 1602260101, 1602250053, 1602260113, 1602240029, 1602260111, 1602230002, 1602250179, 1602260014, 1602260045, 1602260046, 1602250178, 1602260047, 1602250177, 1602250176, 1602260052, 1602250175, 1602250174, 1602260055, 1602250172, 1602250170, 1602250169, 1602260065, 1602250168, 1602250167, 1602250166, 1602260066, 1602250164, 1602250163, 1602260110, 1602250161, 1602250160, 1602260117, 1602250159, 1602250158, 1602260118, 1602260077, 1602250157, 1602250155, 1602260116, 1602260079, 1602250154, 1602250153, 1602250152, 1602260084, 1602250151, 1602250149, 1602250148, 1602260124, 1602260099, 1602250147, 1602250146, 1602260107, 1602250145, 1602250144, 1602250142, 1602250141, 1602250140, 1602260104, 1602250139, 1602260127, 1602250137, 1602260054, 1602250135, 1602250134, 1602260108, 1602250132, 1602250131, 1602250130, 1602250129, 1602250127, 1602250126, 1602250121, 1602260020, 1602250119, 1602250117, 1602250114, 1602250113, 1602250111, 1602250109, 1602250105, 1602250096, 1602250093, 1602250092, 1602250089, 1602250087, 1602260132, 1602250086, 1602230050, 1602250079, 1602250076, 1602250029, 1602260121, 1602250027, 1602260114, 1602250025, 1602250023, 1602230098, 1602260057, 1602240056, 1602260106, 1602260049, 1602260136, 1602260090, 1602260135, 1602260119, 1602260125, 1602260100, 1602260130, 1602260141, 1602260091, 1602260010, 1602260133, 1602260139, 1602260152, 1602260154, 1602260149, 1602260140, 1602260155, 1602260131, 1602260137, 1602260143, 1602260144, 1602260145, 1602260163, 1602260147, 1602250165, 1602250171, 1602250181, 1602250184, 1602250187, 1602260002, 1602260006, 1602260007, 1602260012, 1602260035, 1602260058, 1602260168, 1602260060, 1602260061, 1602260062, 1602260067, 1602260078, 1602260081, 1602260083, 1602260086, 1602260088, 1602260097, 1602260098, 1602260102, 1602260115, 1602260120, 1602260122, 1602260123, 1602260126, 1602260128, 1602260129, 1602260134, 1602260138, 1602260142, 1602260146, 1602260148, 1602260150, 1602260151, 1602260153, 1602260156, 1602260157, 1602260159, 1602260161, 1602260162, 1602260164, 1602260165, 1602260166, 1602260167, 1602260170, 1602260171, 1602260173]
#사업장번호_설치용량 리스트
#installsize=[[1602220001, 64.2], [1602160001, 19.34], [1602200001, 96.78], [1602220005, 20.61], [1602220006, 22.08], [1602220011, 90.0], [1602220007, 14.43], [1602170011, 86.09], [1602230047, 11.2], [1602220014, 27.2], [1602220013, 90.0], [1602220022, 35.24], [1602220019, 176.0], [1602220025, 4.8], [1602220012, 29.26], [1602220017, 12.71], [1602220035, 7.96], [1602220026, 61.2], [1602160002, 345.0], [1602220032, 10.92], [1602220042, 11.4], [1602220048, 6.2], [1602220036, 22.8], [1602220051, 29.72], [1602230001, 20.0], [1602230001, 475.8], [1602230005, 16.68], [1602230014, 13.92], [1602180003, 16.92], [1602230019, 261.86], [1602190001, 537.0], [1602220041, 160.0], [1602220027, 1150.5], [1602220037, 187.0], [1602220034, 169.0], [1602220043, 74.0], [1602230033, 75.0], [1602230038, 220.0], [1602230040, 118.65], [1602220029, 14.69], [1602230043, 20.8], [1602230032, 48.45], [1602230045, 220.0], [1602230048, 27.0], [1602230027, 11.23], [1602230046, 1050.0], [1602230051, 188.16], [1602230052, 14.76], [1602220039, 220.0], [1602230054, 97.5], [1602230013, 0.0], [1602220031, 146.97], [1602220033, 10.12], [1602220010, 106.86], [1602230026, 90.0], [1602220016, 110.0], [1602220023, 104.0], [1602220045, 90.0], [1602220049, 55.0], [1602230023, 260.5], [1602230069, 270.0], [1602220040, 5.7], [1602230055, 30.0], [1602230096, 19.78], [1602230095, 96.0], [1602220050, 34.16], [1602240046, 153.0], [1602250068, 72.72], [1602230049, 3515.0], [1602230035, 26.92], [1602230114, 27.5], [1602240002, 111.0], [1602240009, 60.0], [1602240008, 231.9], [1602240016, 29.07], [1602240019, 75.0], [1602240011, 4.8], [1602240020, 5.67], [1602240025, 90.0], [1602240026, 52.92], [1602240018, 18.27], [1602240030, 150.0], [1602240014, 45.0], [1602240037, 51.9], [1602240031, 380.0], [1602240035, 173.28], [1602240038, 24.67], [1602240022, 185.0], [1602240033, 13.14], [1602240036, 13.18], [1602220044, 727.0], [1602240041, 27.36], [1602230058, 149.65], [1602240001, 48.6], [1602240039, 22.9], [1602240044, 36.0], [1602240042, 382.5], [1602240045, 36.47], [1602240034, 27.84], [1602230099, 12.2], [1602240048, 8.82], [1602240055, 28.96], [1602240059, 8.4], [1602230059, 63.44], [1602230060, 35.02], [1602230061, 116.7], [1602230062, 93.01], [1602230063, 113.86], [1602230064, 112.96], [1602230065, 127.18], [1602230066, 92.5], [1602230067, 62.63], [1602230068, 79.79], [1602230070, 12.79], [1602230073, 25.21], [1602230074, 90.22], [1602230075, 108.77], [1602230076, 91.03], [1602230077, 64.45], [1602230078, 72.28], [1602230034, 59.9], [1602230004, 837.0], [1602170010, 517.69], [1602230007, 151.5], [1602230008, 417.0], [1602230012, 201.0], [1602230016, 612.5], [1602230079, 78.45], [1602230018, 553.0], [1602230020, 167.5], [1602230080, 139.83], [1602230081, 103.18], [1602230083, 107.91], [1602240067, 29.96], [1602230024, 285.0], [1602230084, 25.29], [1602230085, 85.56], [1602230086, 79.99], [1602230087, 140.5], [1602230089, 118.85], [1602230090, 121.07], [1602230091, 48.58], [1602230025, 1622.5], [1602230092, 77.21], [1602230093, 78.1], [1602230031, 139.5], [1602230100, 44.0], [1602230101, 60.0], [1602240063, 93.12], [1602240072, 1.92], [1602180002, 218.65], [1602230021, 94.47], [1602240075, 2.4], [1602240076, 3.54], [1602240071, 241.13], [1602240078, 4.98], [1602240077, 242.0], [1602240081, 3.3], [1602240083, 77.97], [1602240079, 33.29], [1602250005, 52.0], [1602240085, 67.7], [1602240024, 12.45], [1602240087, 45.57], [1602240084, 24.29], [1602240089, 8.41], [1602250001, 220.0], [1602240054, 48.96], [1602250003, 1212.5], [1602240086, 26.44], [1602250004, 93.6], [1602250050, 16.72], [1602250014, 15.61], [1602250020, 524.0], [1602250021, 37.5], [1601040001, 22.49], [1602250026, 31.33], [1602250044, 42.35], [1602250019, 18.1], [1602250038, 26.59], [1602250008, 39.6], [1602250048, 370.0], [1602240070, 309.09], [1602240053, 214.36], [1602250056, 7.52], [1602240040, 9.88], [1602250054, 4.1], [1602240074, 16.2], [1602250009, 110.0], [1602240003, 74.64], [1602240004, 61.19], [1602250057, 44.9], [1602220018, 543.0], [1602230010, 9.86], [1602250046, 77.43], [1602240088, 18.38], [1602240061, 33.72], [1602250055, 11.99], [1602240082, 727.0], [1602240047, 24.0], [1602250022, 38.61], [1602250069, 138.54], [1602250060, 183.04], [1602240015, 55.0], [1602250067, 311.7], [1602250071, 12.31], [1602250104, 23.33], [1602250043, 92.61], [1602250062, 8.41], [1602250077, 9.72], [1602250072, 17.04], [1602250031, 23.23], [1602250082, 27.92], [1602250007, 105.36], [1602250018, 14.9], [1602250042, 44.0], [1602250052, 5.46], [1602250088, 44.5], [1602240012, 42.0], [1602240013, 5.26], [1602250085, 2864.0], [1602250122, 11.76], [1602250138, 36.75], [1602250136, 68.48], [1602250150, 15.98], [1602250162, 31.61], [1602250173, 175.95], [1602250078, 9.25], [1602250017, 81.95], [1602250180, 17.12], [1602250091, 9.0], [1602230113, 40.91], [1602250094, 54.06], [1602250097, 102.69], [1602250098, 83.87], [1602250099, 66.71], [1602250101, 54.12], [1602250102, 24.0], [1602250103, 23.54], [1602250185, 14.58], [1602250106, 17.56], [1602250108, 66.57], [1602250112, 30.13], [1602250115, 63.44], [1602250118, 49.77], [1602250123, 41.75], [1602250125, 280.4], [1602260003, 38.3], [1602260008, 54.39], [1602260011, 22.05], [1601040002, 12.22], [1601140001, 7.03], [1601140002, 44.26], [1601140003, 8.0], [1601140004, 9.99], [1601140005, 9.95], [1601140006, 9.07], [1602010002, 4.67], [1602010003, 7.62], [1602040001, 12.52], [1602040002, 11.06], [1602040003, 7.26], [1602040004, 14.94], [1602040005, 10.97], [1602040006, 11.0], [1602040007, 15.71], [1602040008, 3.83], [1602040009, 16.07], [1602040010, 4.15], [1602150001, 18.36], [1602150003, 12.1], [1602150004, 13.83], [1602170002, 9.0], [1602170004, 18.17], [1602170005, 30.88], [1602170006, 19.31], [1602170007, 5.2], [1602170008, 18.55], [1602170009, 6.26], [1602180005, 19.59], [1602180008, 8.96], [1602190006, 10.96], [1602190007, 27.59], [1602190008, 15.27], [1602190009, 17.2], [1602190010, 4.64], [1602220052, 18.65], [1602230106, 16.92], [1602230110, 10.02], [1602230111, 14.54], [1602250063, 27.88], [1602250066, 38.81], [1602250081, 11.81], [1602250083, 12.31], [1602250090, 12.26], [1602260026, 6.8], [1602260027, 7.84], [1602260028, 9.2], [1602260029, 6.0], [1602250070, 83.97], [1602250065, 44.8], [1602250002, 147.04], [1602250156, 69.69], [1602260019, 14.46], [1602250036, 25.04], [1602260031, 20.95], [1602260033, 14.85], [1602250010, 20.6], [1602250039, 88.19], [1602250028, 9.28], [1602260034, 28.37], [1602260092, 155.0], [1602220015, 5.48], [1602260041, 4.2], [1602260009, 45.43], [1602260013, 10.01], [1602240023, 97.62], [1602260059, 21.4], [1602260015, 8.98], [1602260016, 12.31], [1602260017, 51.08], [1602260018, 6.07], [1602260021, 9.6], [1602260022, 29.77], [1602260023, 33.62], [1602260042, 3.56], [1602260024, 13.16], [1602260025, 23.4], [1602250047, 56.11], [1602250032, 12.61], [1602220020, 34.05], [1602260048, 150.0], [1602220038, 42.27], [1602250073, 48.55], [1602230097, 25.65], [1602250058, 115.0], [1602260050, 3.36], [1602230103, 22.84], [1602250045, 13.96], [1602240069, 16.58], [1602230105, 16.2], [1602250040, 15.39], [1602250064, 153.89], [1602260051, 9.36], [1602260039, 20.69], [1602260063, 29.0], [1602260032, 7.48], [1602230107, 12.87], [1602260071, 10.5], [1602240005, 45.14], [1602240064, 8.81], [1602250049, 62.71], [1602250024, 23.95], [1602230006, 90.0], [1602260070, 220.0], [1602260074, 14.99], [1602230042, 660.5], [1602260072, 15.3], [1602260073, 6.48], [1602250120, 28.42], [1602250006, 23.6], [1602250015, 18.48], [1602230088, 15.4], [1602250016, 16.35], [1602260076, 18.88], [1602260068, 14.96], [1602260075, 203.0], [1602260080, 29.47], [1602260093, 5.6], [1602250051, 24.75], [1602260064, 44.2], [1602260043, 95.93], [1602240006, 30.41], [1602260082, 284.0], [1602260112, 20.3], [1602260005, 16.95], [1602250186, 127.08], [1602260095, 48.75], [1602260085, 105.24], [1602260096, 42.77], [1602240028, 44.16], [1602260094, 8.82], [1602260105, 45.0], [1602260101, 28.8], [1602250053, 47.23], [1602260113, 3.33], [1602240029, 19.51], [1602260111, 33.0], [1602230002, 36.36], [1602250179, 13.82], [1602260014, 8.9], [1602260045, 12.97], [1602260046, 120.28], [1602250178, 21.02], [1602260047, 9.0], [1602250177, 29.93], [1602250176, 12.55], [1602260052, 17.57], [1602250175, 15.55], [1602250174, 10.05], [1602260055, 86.94], [1602250172, 8.94], [1602250170, 12.47], [1602250169, 11.97], [1602260065, 75.74], [1602250168, 11.82], [1602250167, 9.06], [1602250166, 16.61], [1602260066, 92.0], [1602250164, 17.38], [1602250163, 18.46], [1602260110, 88.38], [1602250161, 13.49], [1602250160, 12.94], [1602260117, 885.0], [1602250159, 17.67], [1602250158, 21.49], [1602260118, 6.79], [1602260077, 5.45], [1602250157, 25.34], [1602250155, 13.99], [1602260116, 23.28], [1602260079, 12.2], [1602250154, 23.99], [1602250153, 9.61], [1602250152, 10.38], [1602260084, 130.0], [1602250151, 10.0], [1602250149, 16.02], [1602250148, 17.23], [1602260124, 6.9], [1602260099, 37.03], [1602250147, 18.49], [1602250146, 10.94], [1602260107, 16.62], [1602250145, 10.73], [1602250144, 14.85], [1602250142, 15.29], [1602250141, 17.67], [1602250140, 10.38], [1602260104, 11.0], [1602250139, 16.33], [1602260127, 51.45], [1602250137, 10.38], [1602260054, 23.31], [1602250135, 8.76], [1602250134, 17.23], [1602260108, 4.82], [1602250132, 11.97], [1602250131, 11.85], [1602250130, 10.38], [1602250129, 8.79], [1602250127, 10.41], [1602250126, 24.43], [1602250121, 8.94], [1602260020, 191.04], [1602250119, 14.26], [1602250117, 24.52], [1602250114, 15.17], [1602250113, 10.0], [1602250111, 8.91], [1602250109, 9.2], [1602250105, 11.26], [1602250096, 12.26], [1602250093, 10.11], [1602250092, 29.81], [1602250089, 17.61], [1602250087, 17.9], [1602260132, 21.49], [1602250086, 15.93], [1602230050, 37.8], [1602250079, 17.23], [1602250076, 11.08], [1602250029, 16.76], [1602260121, 295.0], [1602250027, 16.76], [1602260114, 26.16], [1602250025, 11.82], [1602250023, 11.58], [1602230098, 18.9], [1602260057, 23.11], [1602240056, 21.7], [1602260106, 24.64], [1602260049, 7.88], [1602260136, 11.98], [1602260090, 10.35], [1602260135, 73.5], [1602260119, 18.55], [1602260125, 25.29], [1602260100, 120.25], [1602260130, 45.65], [1602260141, 9.7], [1602260091, 26.31], [1602260010, 20.0], [1602260133, 7.64], [1602260139, 29.12], [1602260152, 16.17], [1602260154, 13.14], [1602260149, 40.2], [1602260140, 34.07], [1602260155, 45.0], [1602260131, 6.24], [1602260137, 6.98], [1602260143, 18.16], [1602260144, 24.4], [1602260145, 27.4], [1602260163, 46.0], [1602260147, 4.8], [1602250165, 20.99], [1602250171, 9.25], [1602250181, 14.78], [1602250184, 63.26], [1602250187, 18.72], [1602260002, 14.0], [1602260006, 10.19], [1602260007, 114.21], [1602260012, 11.79], [1602260035, 48.42], [1602260058, 30.24], [1602260168, 80.17], [1602260060, 24.3], [1602260061, 9.86], [1602260062, 39.84], [1602260067, 16.39], [1602260078, 46.54], [1602260081, 24.7], [1602260083, 66.31], [1602260086, 26.22], [1602260088, 42.44], [1602260097, 43.63], [1602260098, 14.44], [1602260102, 12.62], [1602260115, 14.14], [1602260120, 37.03], [1602260122, 9.0], [1602260123, 7.92], [1602260126, 23.26], [1602260128, 45.0], [1602260129, 9.72], [1602260134, 6.88], [1602260138, 13.5], [1602260142, 9.83], [1602260146, 11.55], [1602260148, 18.57], [1602260150, 8.52], [1602260151, 6.4], [1602260153, 6.88], [1602260156, 11.24], [1602260157, 11.92], [1602260159, 7.08], [1602260161, 7.16], [1602260162, 14.48], [1602260164, 10.68], [1602260165, 14.28], [1602260166, 12.63], [1602260167, 16.96], [1602260170, 12.64], [1602260171, 5.99], [1602260173, 17.04]]
##############################################################################################################
